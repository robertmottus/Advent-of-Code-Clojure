(ns year2020.day02.day2
  (:require [ysera.test :refer [is is= is-not]]
            [clojure.string :as str :only [index-of]]))

; https://adventofcode.com/2020/day/2

(declare destruct-pw-string)
(declare xor)

(defn valid-pw-part1?
  {:doc  "
  The password policy indicates the lowest and highest number of times a given letter must appear for the password to
  be valid. For example, 1-3 a means that the password must contain a at least 1 time and at most 3 times.
  "
   :test (fn []
           (is= (valid-pw-part1? "1-3 a: abcde") true)
           (is= (valid-pw-part1? "1-3 b: cdefg") false)
           (is= (valid-pw-part1? "2-9 c: ccccccccc") true)
           )}
  [pw-str]
  (let [{:keys [nr1 nr2 letter pw]} (destruct-pw-string pw-str)
        freq-lo nr1
        freq-hi nr2
        freq (->> pw (filter #(= letter (str %))) (count))]
    (and (<= freq-lo freq)(<= freq freq-hi))
    )
  )

(defn valid-pw-part2?
  {:doc  "
  Each policy actually describes two positions in the password, where 1 means the first character, 2 means the second
  character, and so on. (Be careful; Toboggan Corporate Policies have no concept of 'index zero'!)
  Exactly one of these positions must contain the given letter. Other occurrences of the letter are irrelevant for
  the purposes of policy enforcement.
  "
   :test (fn []
           (is= (valid-pw-part2? "1-3 a: abcde") true)
           (is= (valid-pw-part2? "1-3 b: cdefg") false)
           (is= (valid-pw-part2? "2-9 c: ccccccccc") false)
           )}
  [pw-str]
  (let [{:keys [nr1 nr2 letter pw]} (destruct-pw-string pw-str)
        letter1 (subs pw (dec nr1) nr1)
        letter2 (subs pw (dec nr2) nr2)
        ]
    (xor (= letter letter1) (= letter letter2))
    )
  )

(defn xor
  {:test (fn []
           (is= (xor false false) false)
           (is= (xor false true) true)
           (is= (xor true false) true)
           (is= (xor true true) false)
           )}
  [a b]
  (and (or a b) (not (and a b)))
  )

(defn destruct-pw-string
  {:doc "destructs the policy and password string"
   :test (fn []
           (is= (destruct-pw-string "1-3 a: abcde") {:nr1 1 :nr2 3 :letter "a" :pw "abcde"})
           (is= (destruct-pw-string "1-3 b: cdefg") {:nr1 1 :nr2 3 :letter "b" :pw "cdefg"})
           (is= (destruct-pw-string "2-9 c: ccccccccc") {:nr1 2 :nr2 9 :letter "c" :pw "ccccccccc"})
           )}
  [pw-str]
  (let [idx-of-dash (clojure.string/index-of pw-str "-")
        idx-of-space (clojure.string/index-of pw-str " ")
        idx-of-colon (clojure.string/index-of pw-str ":")
        nr1 (read-string (subs pw-str 0 idx-of-dash))
        nr2 (read-string (subs pw-str (inc idx-of-dash) idx-of-space))
        letter (subs pw-str (inc idx-of-space) idx-of-colon)
        pw (subs pw-str (+ 2 idx-of-colon))]
    {:nr1 nr1 :nr2 nr2 :letter letter :pw pw})
  )

(defn part1
  [pw-strings]
  (->> pw-strings
       (str/split-lines)
       (map valid-pw-part1?)
       (filter true?)
       (count)
       )
  )

(defn part2
  [pw-strings]
  (->> pw-strings
       (str/split-lines)
       (map valid-pw-part2?)
       (filter true?)
       (count)
       )
  )

(comment
  (def puzzle-input "6-8 s: svsssszslpsp\n3-4 n: gncn\n4-8 v: vkvmvdmvhttvvrgvvwv\n16-18 j: jjjjjjjjjjjjjjjjjf\n13-15 p: pppppppvppppxxppp\n3-4 k: bkksggqbtwkkkzqcz\n8-18 x: qxphxxtczxxxxxrbxxl\n6-11 c: dccxcccccchrcfdckcsc\n10-11 c: ccvxccccccccc\n2-4 f: pszff\n18-20 z: zzzzzzzzzzwzzzzzzzzj\n1-7 g: ggggggpggggggg\n3-5 h: hhhhfhh\n2-5 x: dxxzxv\n7-8 s: ssssssss\n3-9 k: ktkkkkkklkck\n2-9 r: rzrrrrrrrrrrrr\n5-9 k: tkrkhkxbvkbkkkkk\n8-9 n: tnnpbnrns\n14-15 q: qqqqqqqqqqqqqqqq\n11-12 q: cqqqqqqqqqsqqqlqqqqq\n15-17 v: vvvvvvvvvvnvvvvvlvvv\n2-10 c: ccccccccvgckcccccc\n8-9 h: hbhhhhchhhs\n7-13 t: thtfttzctpvtn\n14-15 w: wwwwwwwvwwwwwppwww\n5-19 m: mmmmmjmmmmmmmmcmmmw\n2-8 z: mvtnjvzzs\n8-10 c: cccccccxcccc\n8-11 m: mmmmmmmmmmxmmmmk\n6-7 h: hhhhhhhhhhkhh\n6-8 h: xmhsphhm\n2-3 b: bbgb\n2-14 q: qqqqtkqzqqqqqq\n9-15 z: zzzzzzzzzzzzzzb\n2-12 n: hnmztvzxxwvnrnvlfbs\n8-13 c: cccccccccccctccbcc\n10-13 k: jkjzqkkkkmkkk\n3-10 m: mmmlmmmmmmmm\n1-2 r: nprr\n9-15 z: zzfjwgczzzzzzvlqz\n5-6 q: vqqqqq\n3-10 r: rrftrrkrrg\n7-9 r: tqfrrcrvbzrkrr\n5-12 j: jjjjjjjjjjjjj\n14-18 p: phnppvpchpncdppjpf\n3-5 t: hdtrtt\n7-9 x: xxxxxxxxlx\n3-4 m: wmmm\n1-14 l: hllllllllllllll\n2-3 g: jgmg\n17-18 c: ccccccccccccccccctc\n8-13 l: lllllllllllldl\n4-9 v: sbxvbkvfqvvxvnl\n3-5 g: nggxbp\n3-4 t: jtthcmtfnct\n5-6 c: vccwpcct\n4-8 v: vvvvvvvbvv\n1-3 t: qttt\n6-7 j: mwjxqmljtfxbcrjvjjj\n2-3 d: xddxnxmfhvdk\n17-18 j: pcjjcwkjjvvdjjvrjb\n3-6 h: drplhl\n10-15 g: ggggqggggngprggg\n11-13 n: nnznnnnnnnrnn\n11-17 p: pppppxppprpppprpppp\n14-15 d: qdfqdxkqdrqcddr\n3-5 k: tkkknr\n10-11 m: ncmrmxzsszfj\n19-20 w: wwwwwwwwwwwwwwwwtwnm\n4-6 r: rrrrrdrrtkf\n8-10 z: zzzzzzzzzzz\n4-20 b: hmslxbrbrptfcljhblqb\n6-9 p: pgtpptpnn\n5-6 l: lllldl\n1-4 c: cccw\n6-11 n: tnnnnnnpnnvb\n6-8 m: rwxcrbmmvdmqmd\n7-8 l: llllllll\n10-11 s: ssssvssnsslsss\n1-3 f: ffkh\n4-5 j: jlzhjj\n1-3 x: xxxxxxxx\n3-5 r: jvrrrr\n18-20 n: nnnnnnhdnxnnnnngnnvv\n12-13 n: nnnnnnnnnmnkn\n8-11 h: qhhhhhslhqhhhwfm\n5-18 j: hgzmdpkfpnjcmpwtqj\n9-10 c: cccccccckc\n3-4 g: gggs\n9-16 s: ssllsssvkshssjsth\n10-12 v: sbnpkfdmnvqpvkvv\n6-7 t: sfssstp\n1-5 c: hqccccfcccrcmcchc\n6-8 d: qrdwflbdd\n1-2 h: ghwh\n9-10 v: vvvvvvvvcn\n12-14 l: hlzxblbkkrhtllfnn\n1-4 b: sbbbbbbbb\n6-7 l: lhlllql\n13-14 z: jgzcqqgmvdzzzq\n5-14 h: tnrhhmqknqhmhfht\n2-4 h: chhxjfksc\n6-10 s: ljmsgsssstscsps\n7-8 k: mgpzkkkg\n6-7 s: sjskmscfssss\n11-12 f: fffffffffffdff\n1-8 x: xxqjxmgtxz\n12-13 l: llllllllllllfl\n9-12 c: ccbpccdcgccc\n5-7 f: hjfrbgk\n15-18 x: kwmttbfvqcxxjbmhvx\n3-8 q: rqqfqblmc\n3-4 l: nlsqf\n7-9 x: jgdmhzxxs\n2-8 g: ggqtqgkgfggfmg\n2-8 k: wpkzwwkm\n1-9 n: nnnnnnztpnnnn\n3-16 m: lxmqlcpwdfqhrmztsd\n14-16 l: lllllllllllllbllln\n7-8 b: bbbbbbbxbbbbb\n9-10 f: ffffffjbmf\n9-10 w: jrwwwwzmkwwfw\n4-5 c: ccctc\n1-6 l: cllllg\n2-6 k: kwkkqk\n6-13 d: zdjddkxmdqrddtbdgbd\n6-8 k: kkkkkkkqk\n3-4 g: twgsprvgm\n9-10 b: ckbmbshbhbbbbb\n9-15 q: qqqqqqkqqqqqqqlqh\n6-12 n: nnnnnnnnnnnn\n2-6 j: cjnxjzljjlq\n14-16 v: vvvvvvvvvvvvvvvm\n6-13 f: gxffsfgdfpfffffffs\n12-13 l: qdltpbdlzjvllftq\n13-14 j: jjjjjjjjjgjjjj\n7-10 x: sxxxlxwxxxjsxxzqxxt\n2-10 q: qjqqqkqqkqq\n1-2 r: rcdwrr\n1-6 j: jjjjjjj\n9-12 n: nndnncnnnnqn\n12-16 p: tbwnppzjpnpptpncp\n8-9 q: qzqhqqqgqqqqqtqqq\n14-15 c: ccccccccccccmhd\n7-8 b: jpbfjsbb\n2-7 j: jjjjjjqj\n3-5 j: lrzgxjhlx\n5-9 r: rrrrrmrrm\n8-11 k: kkwkkkkbkzk\n2-4 b: nbqpbtzkdrdm\n2-13 b: bpxltqdxbxbjbl\n2-5 h: jhhhz\n5-8 c: cncccvcn\n9-11 h: pfhhjhhhhsh\n1-9 v: jvvvvvvvsv\n7-11 b: bxzxpbbmxfgrkxb\n2-7 d: ddddddddd\n6-11 r: rzczrrtljhzkrkrrbrrr\n7-17 h: jshjhqcrphlsgxlqh\n1-2 n: npkn\n14-18 n: nnnkzntnnnnnnnxnnknn\n6-8 g: ggmfgggb\n7-19 l: llllllwlllllllllllll\n2-5 t: qdftt\n8-10 g: gggggggpgg\n3-7 h: gbtdhwhhkl\n2-7 q: glqqrqqzpvqz\n5-11 p: pcllpxgpldnk\n8-16 v: fvvvvnvvvrqwvvzf\n2-3 k: kbkk\n3-5 x: xxqxvtz\n2-3 m: jnmmdzzx\n1-6 p: zvppppppppppd\n2-10 z: zslzzzzdzzzzmz\n2-5 s: skssrsssssssssssss\n2-6 b: zbbzbb\n1-3 w: twrw\n2-10 k: hkkhtkskvk\n5-8 q: qqqqqqqf\n6-8 l: qrspqlkdcscclllkltkl\n2-10 j: jjjjjjjjjcj\n4-11 t: ckttqtlhclhv\n13-15 p: ghsdsmrjwppmmxp\n7-8 j: btrhmpjk\n6-10 g: ckkxpmqmxgg\n1-3 t: tnmrhtlztgttxxztxv\n2-4 n: kknnnnnnk\n3-6 q: qcqqqwnfqrj\n1-14 v: wvvvvvvvvvvvvvvv\n10-11 j: btvbnjckfmjfpjjzc\n15-18 d: ddddddddddddddfddddd\n8-12 q: qqqqqqqqqqqqqk\n4-6 d: qdzxddddnd\n8-11 s: sssssndmssdsssss\n2-4 d: qdhjddnd\n5-8 f: ffffzffdf\n12-15 f: lzfjpkhswmdrphf\n3-6 x: xbxxtx\n8-12 m: mmmmmmmqmmmmmm\n8-9 v: zvzqgvjvtvv\n2-11 w: bwskvwsqbcbnl\n7-14 p: lpgpxqppppplpvlwxx\n10-11 l: lllllllllnll\n15-16 q: qqqqqqqqqqqqqqqcqq\n8-14 v: vgqvvjxwvvzvvv\n3-13 v: vcvzclwbtvbgcngwghh\n3-5 w: zwwnrwww\n3-4 k: hkkkkk\n3-13 h: whhhgqzwjkjqfjc\n4-5 m: mmmmmmm\n5-7 k: pkkkkxxkkk\n1-4 f: pqkff\n1-5 x: xxxxvx\n1-3 t: mtht\n4-6 j: jvjrcfl\n1-5 t: jtmtttc\n7-8 k: kkkpkkkkkrkkqk\n4-5 t: jtttt\n14-19 z: zzzzmztzczzrzdzzzzn\n14-16 s: nqvfdwmtvbsbtnks\n12-14 g: gggggggggggzggg\n6-9 m: llcrncdzmqlzh\n7-14 r: rnrbbwrglbljrw\n4-11 c: ctccccctcch\n18-20 j: jjjjjjjjtjjjjjjjjjjj\n5-6 c: ncccrc\n2-4 b: wbbk\n1-2 t: tstf\n15-17 h: hhhhhzhhhhhhhhxhhh\n11-14 k: kkkkkkkkkkgkkkk\n9-13 n: vcqnnnlcnnnnq\n2-5 s: slssn\n6-8 m: bmmmmmqwmmmm\n8-9 c: cnccccccrc\n3-4 s: zcss\n13-15 c: cccjgccchjcmccrdcccc\n4-6 r: fkvpfjnflkrrccz\n2-6 s: shssssssss\n12-14 r: rrrrrrrrrrrrrv\n5-19 h: hhhhmhhhhhhhhghhhhhh\n4-9 b: gjntfbwtb\n12-15 n: nzndcrnjnnnnnngnd\n11-12 z: vqzjftszbzzz\n16-18 w: wlxwzwwczqwmtrpwbwg\n3-11 g: qmgghrggggt\n2-3 v: vntvvvvvvv\n7-11 b: bbbbbbbbbblb\n2-3 t: nctttjgr\n1-8 t: nrlrtnptztstnfstx\n1-4 r: rrrz\n12-13 z: zzznzzzvzzzzhczz\n12-13 n: gnjqqnnnnnnnnnnnsnnc\n11-12 g: ggggggghgrjg\n2-7 q: ljsvqlq\n3-9 h: wlkfhjvthpfhzln\n8-10 j: jkxzjjjbjjjjjf\n2-5 p: pqppp\n2-7 c: cmhgqwswwwjvwx\n3-4 w: wwww\n6-7 z: nfxmzdzk\n7-12 q: rqqbqxqdwchf\n3-4 l: llzrl\n4-5 h: hftdhw\n8-15 x: pxcdzxldgxgmpxxmxsv\n8-10 h: hjhkhdkgghhhhhwh\n10-14 n: npnnnnnnndnnnn\n3-7 m: dhmtmhnx\n3-4 p: fphp\n1-2 t: tttmvv\n13-17 j: qrjvzjbvjvvjjsjhg\n14-19 v: bvvvwdvbngqnzfnvvvv\n4-7 c: ccczccccq\n3-13 h: hxsghhnhhhhhhhh\n2-7 n: nnfnnnnnnh\n13-14 w: wwwwwwwwwwwwwjw\n6-11 d: mdcddbdrddd\n15-19 r: rrgrrrrprrrrrrdrrrrr\n11-16 x: xxxkxxxxxxmsxxxxxxx\n4-13 v: xvqkhfpvlsvvvvs\n2-3 x: jxjbxbq\n11-14 s: fdjtpsgsrgdlksskm\n7-8 x: rdsxpbzwxnkxvd\n10-11 f: ffffgffvfft\n10-11 p: pwjzmsnqbps\n13-14 b: bbbbtbbbbbbbdj\n1-4 x: xxxgg\n11-16 c: ccwlggccckwccccccc\n10-12 g: ggggggbggkgqgg\n3-4 q: kzfqqc\n2-10 r: rsrrrrxbgrrrrhrrrrdr\n1-2 s: mssksf\n2-5 q: bqnwqpmtglphq\n4-11 h: hhhmhhhhhhhh\n5-7 w: wwwwnwxww\n3-4 n: nmxc\n7-8 c: wcrcmccq\n2-10 x: qxctcjtmvbj\n8-14 w: gwrtwflwfsgwzwmmw\n2-4 z: wzjzlc\n2-11 m: zmctnwcvwhmgcq\n5-19 v: gcmvfvvkvxdmvvxvwgvv\n11-13 c: cccccpcccwcphcc\n5-6 j: pjjtcbprsjjhnz\n6-8 h: hktwdmsc\n2-4 x: kxxlx\n3-4 l: tblq\n5-7 r: lpqbmmrhtmwrcvlt\n3-4 z: zbhzmz\n9-11 n: nnnnnnqnnnn\n3-4 g: cdgd\n4-7 j: jnqjssh\n6-9 p: prlsjpmmn\n10-11 f: fffffffpkzqqffrf\n3-7 k: kktkkkkk\n1-4 q: qqqrqqqqqqq\n10-13 l: llllllsllnpllllll\n2-6 d: hdxhvdz\n3-4 s: kssjq\n8-10 t: rtdttdcttp\n1-2 x: xxjxxxxbx\n11-13 x: xxvxxxxxxxxxj\n6-10 n: xnnnkfwgnn\n3-4 c: cwfcc\n16-18 j: jjjjjjjjjjjjjjjjjpjj\n4-7 n: lnqnlndbnf\n11-14 k: nkkkkkkkkkkdkkkkk\n2-6 j: jjjjjcj\n13-14 v: vvvvvvvvvvvvvvvv\n10-12 v: vvvvvvvvvwvv\n3-13 z: nzhzvmzcbzzzzzj\n2-6 d: dddhthddddddq\n6-7 s: ssssscs\n5-8 f: ffxffffdff\n10-14 r: rvdzskgrmrrsxgc\n8-9 s: sssssssss\n3-5 g: khgkl\n5-6 n: nnnbnnn\n1-9 w: wwqpwhwcdw\n7-8 g: gxgggrgcggg\n5-8 w: wswwnwwwwxwwwwwwwww\n4-11 b: svbwbqsbbbbbnpcbpprb\n6-7 j: zjvjmsjjjjnvt\n5-6 l: lhlllpll\n1-2 b: bxbbxfbxb\n9-12 g: gjgqggggzggffgp\n3-4 v: wjfvsvd\n2-6 v: fvvpvcxnpgd\n9-10 q: qqvqqqqrrq\n15-18 k: kjkkklkkxkkqnsgqwkt\n1-4 z: zsjf\n2-6 l: dvcsllhw\n10-12 x: xxxxxxxxxxxxx\n5-6 g: dtggpgggcwvvdw\n5-13 p: ppppkppppdpvdpzdlppp\n3-7 d: ddwddddlddd\n7-12 r: jrxbrprrgngzpjjc\n4-7 m: mmxzmfmmlmm\n3-5 m: pgtmz\n6-13 z: dzpdlrsnxzshkbtlxvmn\n6-12 x: trszxlcdxknxnnj\n6-11 k: xgkbsqkgnkk\n7-10 r: rrrrrrxrrsrr\n6-7 t: ctwmxntbdl\n5-6 d: dbcddc\n8-18 m: wtmtmtvmcmmjsmmxmmmm\n3-5 k: dnvxk\n6-7 b: bbbbbbl\n1-5 c: cqzfcjhnccjwwjftkx\n6-9 d: hwsbcdmrldpszh\n3-7 f: gffffff\n13-17 b: bbbtbbbzbbbbsbbbjbbk\n1-3 w: wwwhw\n5-6 b: xqbgbxblbbb\n5-9 p: phhpqppppgtppp\n3-8 z: zzzzcrjbzzwzzzckzz\n1-3 b: lbrbnbbbb\n3-5 q: gqqgf\n10-11 c: jcccccjzccmcc\n4-6 l: dlpggl\n5-7 n: nnnnpnnn\n4-6 f: sffnfslkffdfff\n4-5 s: dsssj\n2-5 v: vvvnnhvv\n1-3 f: bfff\n8-14 g: gcndkmgfnpmsmtm\n1-12 d: dddddddtddcdd\n12-14 t: ttttttttttxttttttttt\n2-6 w: mwwmvmpwzwpzkn\n9-12 c: ccccmcccmccbcccc\n1-7 c: ccgncfc\n3-6 w: wrrwwww\n6-7 s: szpvlbhsbtktl\n3-4 f: wfmfw\n12-17 n: nnnnbnnxncnnvnpnjnr\n5-6 h: hhhhth\n1-3 q: qnbqf\n3-4 s: fmsj\n7-9 l: nlwlflsllllk\n9-16 s: xxpzsmvhbsssdkps\n6-9 p: pstppplpr\n4-6 r: rrrrrr\n1-10 j: hjjjljjjjwjjj\n13-20 c: qclflvdlmzwmtgfctwhc\n6-7 b: bbbcbdb\n8-13 r: wrrzbcwvfqkfr\n13-14 r: rrrrrrrrrrrrrg\n2-15 j: jhhjnvgxzbjskjjj\n2-4 p: ppghp\n4-5 s: gjmsrksvqqssslss\n15-17 h: hhhhhshhhhhhhhhhh\n3-5 c: lcclm\n5-6 j: gjnjgv\n9-10 z: lzzzzzzrtdzqzz\n2-3 s: qksnrsvvb\n5-11 d: ddfvzdddkrgrddr\n15-18 v: vtcvvlqsqvpkvvmvhv\n3-6 j: kbgjshj\n1-4 r: rrcrrrhltr\n3-4 q: qvfq\n4-8 w: mzwwswwttnxmkp\n2-3 b: zblbsbncbk\n7-13 k: tdksbkckckkjk\n8-9 h: hmpzhxhkhmlhzhkqph\n3-9 p: ctrjcknnrzpxklt\n1-3 d: ddgd\n8-10 t: xttttdttqs\n4-5 k: bkkmk\n6-7 k: kxtxkkcpbfb\n11-13 r: znbhrsrrrdrrc\n14-16 x: xxxxxdxxxxxqxlxx\n6-15 x: hxlxxxxxxqpjtxwxxxxx\n8-16 l: qlqwrlllphlllllxglll\n14-16 m: mssmmfmwlqznhndh\n1-9 h: hhchhhhhfhhsmhhhh\n6-9 b: bbbbbbbbt\n5-6 r: mrfrjr\n7-8 x: nxxxlxlxbxx\n6-19 t: tkhdtvtblvnlqbjsvct\n4-14 p: vpnpntggdzctqpbrl\n9-11 n: nnnbnnnnnhnn\n1-2 p: whppppwpppppzpqppp\n2-3 m: bbqxwvjxmnxh\n2-4 c: nczcwqwkctzwl\n3-4 x: xxxvxx\n10-13 w: bzqgckszwwjtl\n6-9 g: qhggzggjfjgghwrkfbg\n15-16 n: nmnnnnncnnnnnnnkndn\n3-11 r: frrrrrprrrgrrr\n6-7 p: pppdppg\n3-8 s: lzdthfbsfskk\n4-9 h: bmrhdrzbhtmx\n10-11 m: mmgtmmmmmgmmm\n7-8 k: kkkkkfxkkkkkkkkbk\n3-5 n: nnnnnn\n2-4 f: sxxfbpshndbkkmwf\n12-13 p: prpppppppppfppp\n2-3 f: wtff\n2-4 m: pdmmm\n2-3 d: dddd\n10-11 m: mmmmmmmmmqnmm\n1-3 w: wpcwwnwkr\n1-5 q: wqqqqqsqqqqqc\n1-4 h: mrhhh\n4-6 w: wxlwvwbhzwwkps\n7-8 z: pnzgfkzhqfw\n1-3 z: zzqz\n3-9 r: rrmrrrrrrrrrr\n2-5 f: ffffqffjn\n2-6 p: rpqtkc\n1-3 s: gsss\n3-5 t: tkttttwtkjxlq\n5-7 w: wkmwnpbw\n3-10 v: vvnvxvcjvvzcvcvvtv\n1-3 v: vvwvt\n2-15 t: ttttttttttktttnttt\n15-17 w: qrcfnqkflswwwlxwzwdl\n6-8 d: sddvdjdmdmd\n1-3 p: kppppppcp\n8-17 v: mtrbwzbvzjvtmmzxw\n3-5 s: mnsss\n1-9 b: jbbbbbbbbbvlhbbb\n8-13 f: fffffffffffdvfff\n11-12 f: fffffffffffm\n1-4 z: zznq\n10-12 t: tttttttttttmtttrtt\n8-10 g: gggggggxggvgpg\n8-9 d: ddddddgdwrpdd\n9-10 b: dfsbqbrbjbptrlxrbzf\n2-8 c: hcczwkwcspccrcckc\n7-12 s: rhmtjmsjhdsqpr\n9-14 q: wqqqgqqqvgvhvqlqv\n4-6 s: jbgnsss\n2-9 k: jkjbktwdrdnn\n4-11 n: nnnnnnnnnngnnnn\n11-12 j: bswbpbkdjzkj\n3-4 j: crjjqc\n7-8 g: gggtzglg\n3-4 r: gzdr\n4-5 h: hpkhsrhshcht\n6-9 h: mhhhhhhht\n4-9 l: dxbqtftsl\n3-4 k: qfkkkkn\n8-10 p: jwhmxpppfhjhzdj\n6-7 g: bgcgggh\n7-15 x: zxxxvxxxmksxxxnxxrr\n4-5 v: vvdpvnv\n5-9 l: llrqhllcl\n4-5 q: vqqqk\n11-13 d: drddwqlddcdsddzzxb\n1-2 g: gmdjg\n10-11 b: bbbbbbbbbbmbbb\n9-16 d: ddddddddtddddcddddd\n6-10 j: jxjjrjmvwwjjsjjcth\n3-4 f: fqnfdqt\n2-7 p: mppmnpp\n3-5 z: lzzzzzjz\n1-10 m: msbjbgmmkw\n18-19 t: lzttqtttkttttstjbtr\n1-2 b: bkbzb\n2-11 v: vgwrcfcszcvlwt\n3-4 z: jzzx\n3-8 t: ttttttkttfkt\n11-18 b: vjhvwjbwcwbffmpbbr\n6-19 d: kgwqcwbphdwwrddzkzd\n6-7 p: pppbbcpm\n2-7 p: ppdwknp\n4-8 t: rjdtmftjgftwt\n3-7 l: clljldl\n6-7 c: qpcsczccccccmrh\n6-8 f: fffffcsf\n10-14 v: lvvlklxxvvsnvk\n10-11 f: ffffffffffgf\n10-12 v: vswclpclcqtvvrrzf\n6-8 g: gjgggpggghsgggggg\n2-13 k: kkkwckkckkkkvkkkk\n9-16 r: jtrrrbqrnrpjrrshxc\n7-8 f: pvmjhfhg\n7-8 d: xdddddnddd\n2-4 r: srxrrphrb\n2-3 v: vvkgd\n2-5 z: bzzzzhh\n11-16 h: hnchhhhhhhghhhhh\n10-12 p: pzppqppppppb\n13-14 p: pppppppppppppkpppppp\n12-15 z: zzzzzzpzzzzzzzfzzdz\n9-10 z: zzzzzzzzpz\n4-9 j: wfjjntmjxpdq\n9-11 t: tklpbmlntjs\n3-15 m: qmxmwjmmjgmsmwmz\n2-3 g: hgggp\n1-8 d: ldddddldfddd\n7-10 t: ttcttttztw\n6-8 n: nwcjdgbnmnndltr\n11-12 t: ttttqqtttnhttvttt\n6-11 r: rnrhrrrrrrcgtr\n10-12 l: rlllrxwljlwtzl\n18-19 m: mmmmwmmmmmmmmmmmmnmm\n7-8 v: fsvvvdvkvnvgwvvv\n16-17 m: mmmmmdmmmmmmmmcsmmm\n7-8 p: pppppwpfb\n5-8 j: vtjcsjjcjlj\n6-11 t: ttttttttgmqttt\n4-13 t: vkmtvvqxclcpmtrpl\n1-9 s: dsssssssds\n5-6 d: dddddpdt\n1-9 p: pppppppptppp\n15-16 f: pqfjqfdpfxcvwbnf\n5-6 d: tcgdwd\n3-11 f: tpfqgzkfrvqrjfhrrf\n1-3 t: ttltt\n11-12 q: pqlqjqcwjqqv\n1-8 f: vqtdxgsfkjmncxdkqdfb\n4-5 n: nnnnnn\n9-10 g: jgggfgqglgghxgg\n7-12 x: xdxxkcxcxxxm\n5-13 f: fdglsggrwpmxfnm\n1-11 x: wxxxxxxxxxgx\n13-15 d: dddbdkwdldzdddd\n5-10 g: cpgggccpvkzggzgbgtgg\n1-4 w: wwzvq\n3-13 h: zzhnhnjhhkplhhwph\n4-6 f: fffkfff\n6-7 v: vvvvvvdv\n3-4 v: ktvttmvsc\n11-13 c: cccccccccctccccccc\n15-18 j: jjjjjjjjjrjjjjxjjvj\n5-13 v: vvvqzvvvvvvvvvvv\n5-17 q: szncqqqlmcspmcbgqhq\n2-7 s: tsrnhjslffbsv\n13-17 b: vvbhmbmlzsqbwbpkb\n16-19 f: nftvgftdfdrffjtfgvf\n15-20 n: nnmnnsnnlnnncnnnnncn\n18-19 f: fffffffffffffffffkf\n3-5 b: bhnbbm\n1-6 j: jbjjwjjjjjj\n3-8 h: hhhhhhhlhh\n13-16 k: hkxtvdkgpkpkkcfdtkr\n12-13 q: qqqqqqqqqqqjq\n2-3 g: ggkgggg\n11-13 c: xcdxpcnzcsckl\n2-11 l: xlbsbrrnlllpl\n3-4 l: llml\n2-7 c: wscrkcvncc\n9-12 k: dlwkkrhfhkkkkbvfrw\n8-14 w: xggjtvwbxccdqww\n2-4 w: lcswnmwsprkhg\n12-13 b: btfpmbbbsxzbb\n10-12 p: ppjppppvpppqpp\n7-8 r: rrwvcglg\n7-19 p: pmrhpppppppsppppjspp\n2-4 l: xllxb\n6-15 k: ktknghkkstkkjkkx\n3-4 p: pppq\n5-6 g: svmgpgcvbjh\n4-5 n: svnnnrnpn\n5-7 b: vsbgpjl\n4-7 m: mmsmmmnhmmmm\n5-7 t: lvdxtpx\n5-10 k: sxkkgrkkqt\n7-10 k: sskkqxzhkkpzkkvhkkb\n7-13 s: zskccbtsbssdctlmvsss\n7-8 r: lrsrrrscr\n7-13 p: ppfppvpppmppdppvfpg\n7-8 d: ddddhhjd\n2-5 r: thbkr\n2-4 k: kkkkk\n5-11 x: xxxxzxxxxxx\n7-8 v: zbcfxnlv\n3-5 w: nmwvjw\n1-10 h: fqhqhhhhhhhhhhzh\n15-17 j: jjjjjjpjjjjjjjljj\n11-12 f: ffffffqmffmfff\n5-7 p: ppppmpp\n6-11 n: nnnvkjrqwnwn\n1-4 n: nnnccb\n3-5 t: tnkttwbttchst\n4-5 v: nvdpvtrvt\n12-14 d: dddddddddbddddrd\n2-8 l: clvlhdxtqqzdsd\n9-12 z: bzzkzzrzzzzhz\n3-4 p: jpqlkgl\n4-5 j: jjjjp\n2-8 f: vfnnlxfrll\n8-11 p: ppqppppwpplpp\n9-11 k: kkkkkkkkkkk\n3-4 l: lkjl\n1-2 q: qnccf\n3-5 x: wxkxzxcjk\n13-14 g: rzwvvthgrlfjgd\n16-18 d: dfdldddddddddddhddd\n12-16 s: sssdssqdrsssssss\n1-7 k: kdkkwkkvk\n4-6 l: mvrlllzn\n5-7 l: lwdhgzl\n4-11 h: dvhhjdhhjkhbcbhb\n15-17 p: sppppppppvppppppn\n1-3 c: cccc\n4-5 r: pdrbrfbnvbrgwxtwstlj\n16-18 p: pnpphvpppwppknpxpp\n1-8 p: zppppppbp\n1-2 k: xckk\n1-4 d: dddgd\n16-17 p: ppppppppppppppppf\n3-4 v: vqmv\n4-5 n: ncknqlwnrnjn\n8-9 t: tttttttpt\n3-6 m: bfpvxmtzmw\n1-7 g: qgggjggggggg\n2-4 j: nwwjrmckjjg\n6-8 d: hdcjwgddpwhkt\n6-13 r: rrkrrrrrrrrrjrr\n13-14 n: nnznsnnnnhnnnnnnn\n3-7 h: kbhhhhhbqhhhqhhh\n6-9 k: kkkkkkhkkkkk\n3-5 d: wthbpm\n6-7 s: ssscsstsss\n5-12 s: ssbsjsssssssssssss\n4-5 k: wzsnxlk\n10-11 q: qqqqqqqqqjqqq\n6-7 r: trrrrrdr\n2-4 l: hjhljhl\n2-4 v: vhbv\n16-17 j: rjnjjxtbjjjjjjvjn\n4-8 w: nwswjktwznhwtzbdrp\n6-10 f: ffpfbsvcfm\n10-12 b: kbbbbbbblxbb\n4-5 x: qxxcxx\n6-8 d: bhdcpdmrwg\n5-11 d: xdmdvkdddddxddd\n3-4 d: ddddp\n1-4 q: xqvq\n1-5 x: xxxxzxx\n10-11 x: xxxxxxxxxxzx\n7-8 n: nqdnnnhrnn\n9-10 q: zqqnqtxgpq\n2-7 g: ggwgrfwgzg\n4-5 p: prppp\n2-4 d: glnmd\n1-3 f: fflf\n3-9 w: zwbwdzqzw\n4-5 t: tvttt\n10-17 c: cflcrfcccsfzcftvcgc\n5-8 x: xxxxxxxt\n3-5 j: hjljjj\n18-19 z: zzzzzzzzzzzzzzzzzzd\n17-19 l: llbhjllrlllllllgrllf\n14-16 f: vffmmfffwfrqgfdmd\n3-4 c: ccckcgccd\n6-8 m: lxwmxmkrk\n9-11 j: jmjjsjxjnjdj\n9-10 r: xhpccrrrsr\n5-12 q: qqqqxqwqqpfrqqqq\n3-5 m: mxmtc\n4-11 b: gbzxxbjrrctlrrv\n8-12 m: mmmmmmmlmmmm\n7-10 s: sssssssspfr\n2-3 n: xnhn\n1-3 p: btppz\n12-16 l: lllxllllllljlllll\n2-5 d: zddtm\n5-14 p: pppppppppppppsp\n9-11 k: kgkkmdzfkjkzpnz\n11-16 c: kbccczcccccnhccq\n1-2 p: pvph\n2-3 l: llfxvq\n12-16 l: lhhdzwczgrsxgkqd\n6-9 c: ccccccccqctccccccc\n8-9 r: rrrrrrrsr\n2-7 c: slccmjcccc\n2-14 n: whwqmdlrxmxzzdz\n10-11 v: vwvvkvvvvvvvvv\n5-6 j: dfjkjbcsjqjjhkjmg\n6-8 f: fffffffff\n8-15 s: tsszssjsssssmsss\n1-5 k: kkrblv\n6-7 j: jjjjjjv\n2-7 q: dvrnqtq\n6-7 v: vnvqwkvvcxpjmvvmg\n13-15 h: hhhhhhhhhhhhkhth\n10-11 s: skvssssssds\n3-5 b: zbmjbhbbcbbbg\n6-7 x: kxxstwfwbcxdxvjj\n3-9 l: lljlllllrll\n12-13 p: pppqppppppnpp\n4-5 s: pfmpn\n7-8 v: vkjvvvvb\n8-11 t: tttxtlfhtftttwbttt\n4-5 h: hvshsjhvb\n14-16 b: bbbbbbbbbbbbbbbw\n6-9 l: lxzklmgll\n2-7 n: nnnnnnnn\n1-8 x: nxxxxxxxxxxx\n16-17 q: qqqqqqqsqqqqqqqwf\n4-17 c: cgndccccscchqhxcbcc\n4-7 b: bbbbbmn\n12-14 p: pppppppppppppdp\n3-4 t: nttttrvrtd\n5-17 p: pxhbppfpjzzkpgdvb\n7-12 c: ccccccccsccvccjcc\n1-11 t: tjsjxctpbngtdvbdmlm\n3-5 n: wgmwnjwnnnkcnlqqr\n19-20 p: hwfknlcbnhmvkcrpjwvp\n4-7 f: gvlhxkffvd\n4-7 d: ddddrmhfdddfxf\n1-2 q: qxnq\n3-7 k: kqkqskcslcqbxkdsr\n3-6 w: wngwxz\n18-19 k: kkkkkkkkkkkkkkkkkkqk\n6-7 v: vvvvvvtvxq\n1-4 w: wwkrmwwf\n2-3 c: ccdcw\n5-6 w: wwwwsw\n10-11 f: fcfwgfrdzbwfffx\n7-10 d: dddddmdphbtdpdddd\n2-4 t: dmtt\n18-19 s: xsdssssnnnssxqcvssg\n8-9 q: qqqqqqqqqq\n18-19 c: ccxccccmccfccsbcbcc\n1-3 k: kqdwsfkdxl\n5-7 t: vtdtntttlrtt\n2-10 w: wvnfvctwmwwwqr\n1-11 c: lccccccccccc\n6-14 t: qbtkgmscnbztcth\n2-6 n: mnjrfnpmwnlhwvksmmss\n8-13 m: mzzmmpmmmmwmz\n4-7 t: nqvtjnttfsmc\n8-13 p: pppppppppppts\n10-12 b: bbbbbblbbvbbbb\n2-3 b: bbzdv\n5-6 x: tmxxwx\n7-11 q: kqbqqqqqtqfx\n1-11 n: tnlnxpcqnnn\n4-6 j: jdjxcjbggjcdjpknx\n6-11 w: stxldwdvstwf\n3-10 g: qggqjgfxqgmjdgv\n10-15 n: nwnrnnrwnnnnnnc\n6-15 l: lflldhzbllzlbklx\n1-2 s: hsgsj\n5-6 f: ffffdff\n1-5 m: bmhmm\n2-6 m: bmlbslbgjm\n14-16 r: rrrbrrjfrrqrfcrrr\n3-4 x: pxtx\n7-9 b: bbbbbbwbb\n15-17 q: qfqqzqqqqqqqqqqqnqq\n1-4 j: tjjjjj\n1-10 v: vvvvvvvvxvvvvk\n3-4 h: hhzhh\n1-6 h: hhhhhxh\n1-9 s: smwssfhsvs\n13-14 s: tswmwsgtnlpwsn\n4-5 v: vnkvvzs\n11-14 x: xxxxxxxxxxcxxxx\n14-16 n: nnnnnnnknnnnhpnnb\n7-9 k: kkkkkkrkkkkk\n3-5 q: qqqgxscqm\n17-18 n: njhmndnnpnvnnnnnnn\n4-5 h: chshwj\n11-13 z: zzzzzzzkzzlhfz\n7-14 q: qqqqqqlqqqqqqqq\n17-19 v: dvvvxtdgpxvbvvvzvvmv\n7-9 f: rmffffffc\n4-8 r: rwrqrlzrxrrqsccq\n2-3 v: vtvv\n4-5 x: qxgrnxxzbv\n14-16 w: wwwwwwwwwwwwwwwc\n2-6 c: tcvmrcht\n6-9 z: zzzzzzzzz\n9-14 n: nnnswrnnnqmvcnnb\n3-4 f: frxfdff\n8-9 n: nnnhnnzsn\n2-13 w: wmwwwvwlwwwwttqjjwc\n5-6 l: lllllj\n8-11 w: pwrbjlwwwhvxhnsvwh\n3-7 n: kndzxnsnn\n13-14 x: xxxtxxxbzxxxxnx\n13-15 c: ccccccccccccccz\n12-15 n: nnnnnnnnnnnsnnsnn\n4-10 w: wwwrwwwwwwww\n12-16 r: wrrrrrrrrrrgrrrrr\n8-11 l: nlllxllzllll\n3-5 d: prdfhhvdrpd\n2-3 t: wttzbp\n3-5 h: jhxhhdztw\n2-7 r: qrwcxjhtrrlw\n11-13 d: ddddddddddfpdd\n10-11 q: xqztlqqqqqk\n1-11 z: jzzzzznzzzq\n9-10 b: zbbbbbbbtb\n9-10 k: xktkkkpgnpkskkkzjkm\n14-15 j: jjwjjvjjjjjjjjvjj\n2-6 l: lntrlllx\n12-13 g: lgggggblghggmg\n11-12 x: xxxxxxxxxxvxxx\n3-5 l: llllm\n7-12 x: ffqrxjxxhbbp\n16-17 j: jjjjjjjjjjsgjjjjb\n1-5 g: hcfjntzgcxk\n3-6 v: vvqvvqvvv\n1-12 p: pwjdppqpcgpplgwz\n5-6 d: ddbdpd\n8-10 t: twhttnrnpt\n15-17 v: vvvvvvvvvvvkvvvvxvv\n13-15 f: dffjnhmxhbwlfkv\n4-12 c: ccccccccdzccccc\n3-12 p: rvpgssncpbqlkjc\n1-2 h: hhhl\n1-2 j: jkjrxqj\n4-13 b: bbvbbbbbbbbbbbbbbb\n6-11 q: ntqqhqvgqhkhz\n10-13 c: cdcckjgcwdcsct\n9-10 f: fffhffvqff\n5-7 m: mmsmklm\n7-8 z: zzzzzpzxlzzg\n2-12 f: nddlfsjrlhqv\n5-7 m: bvmxmwmlxpmmwt\n1-11 n: fbsghrrzbtnmn\n13-14 h: hhjtlhhhhhhhfhphbhh\n5-7 p: ppppdpspp\n6-7 v: vdvvvvhv\n6-9 k: kkkmknkkkkbc\n2-9 k: jvpczkkcnvfvm\n5-6 g: vgkggb\n4-9 m: mttsgntmmq\n4-9 x: vxxxxxxxz\n2-5 h: gqhhhh\n1-9 m: nkcwjmqmmgldxwm\n3-5 v: vvvvvv\n5-12 z: zzzzzzzzzzzwzzzz\n4-5 l: llglt\n2-8 w: wqwbwkzwsc\n4-6 c: ccctccc\n8-9 g: gggggggpgggg\n6-9 x: xxxxxpxxc\n5-6 k: fcbffhkbtr\n4-5 f: bffvfffff\n2-5 w: wjtgw\n13-16 z: zmzzzztzjpzzzqzw\n10-12 q: qrqqxqqkjqqcqq\n2-9 n: nnnnnnnnnnnwnnnnnn\n3-5 l: hlsgqtvv\n4-6 c: gcccnscccllfq\n16-17 l: llllllllllllllldlll\n6-9 h: lhhhhbhhj\n15-17 r: rznrrrhltxfrrkpjwrrr\n7-8 t: tttttstt\n7-16 j: kmjjcfjjcjjjjbwjjpjr\n10-13 s: sqjvssssstrhd\n8-11 q: qqqqqqqsqqtqq\n8-11 m: xzhlmnmnmkw\n17-18 r: rrrrrrrrrrrrrrrrpk\n1-3 l: xljlml\n8-11 m: jwtdhpmkqmqphms\n9-11 h: zhhrhhhsthhhhhr\n5-14 n: rkndnhgbnnwnnzgn\n8-9 f: lfnfvdgfw\n2-8 q: sdqqqqqqqqq\n1-3 c: jtcm\n1-2 v: vvxv\n2-7 b: bbbbgbz\n5-6 v: vvvvvvv\n3-4 n: hnnmgqt\n10-11 r: rrrrrrrrbrbqr\n3-4 x: xxxcxk\n2-3 j: jnjjjj\n10-12 f: fffffffffffcf\n13-16 d: dplpbdkxzjdlddddm\n2-10 h: hjhhhhhhhjhhhh\n8-17 q: xzszqwgpmscpcfqwkp\n8-11 q: qqqqqqqvqqqq\n3-4 j: lsjj\n8-9 z: nszzjzzczzzptgkbd\n7-16 n: nnnnnnnnnnnsnnnlnnnn\n2-16 p: xswnqpctbvmllwjpw\n1-3 r: rrgrrlr\n3-5 w: wwlwh\n3-9 f: bffktxcwpfhckffr\n5-6 g: ghrjzg\n5-9 k: xhnltmktkt\n1-6 x: xxxxxxxxx\n1-4 l: bllslllbnl\n8-16 v: lvvvvvpvzvvvvvgwjvvv\n8-11 j: jjcjjfzjjrj\n2-7 c: wqcrhxcg\n10-13 p: ppdppppppngbpdppz\n1-3 v: gbflwpsdgnrzhkdv\n3-6 w: pwhbwwwtww\n1-6 f: qmfwff\n11-16 x: xxnxxbxxxxgxxxsxrx\n3-11 b: cztbfcbpcbb\n3-8 l: bmljlgkjcw\n11-14 c: hccccccccccscp\n4-7 l: qlpxbll\n5-6 b: kscpwb\n2-4 s: sgtsmlhcm\n5-6 n: nnnnnt\n8-12 c: rcksqgcqcpfc\n3-4 w: wclw\n6-10 s: wlskbsmjkjngqqs\n16-17 g: dfgggggwbgggggggt\n1-2 k: kdjb\n2-6 p: lmpppp\n3-5 f: ffcfh\n3-4 w: wwjl\n4-7 v: vvtxvwvsqb\n4-6 s: stslsxs\n11-15 x: xrxcxxxxxxvxxxxcx\n4-7 r: xrrlrrrrr\n5-10 v: vvbvsvtmtvvvvv\n4-8 b: cbjbbmsx\n1-6 t: tttttgtt\n3-7 m: mmkmmmmm\n13-16 p: ppppmdspppgpwbpppplm\n2-6 h: tlfdnhz\n6-7 f: fsnfdftgsfdt\n9-10 c: jcccjwgcccsccxnc\n6-14 h: hhphhhrhhhhhhklhhh\n6-8 r: xrrrrrrrrg\n8-10 g: kgjgzgxgnwg\n5-13 p: fdkrpjzttpgpp\n8-12 x: xxxxxxxtxxxx\n3-9 v: nvprvvvtxvvvv\n5-12 g: gggggggggggjg\n2-4 x: sxxsxxdxxbqsgxhqqc\n9-10 j: jxjgjjmgjcjzjjjjj\n13-14 d: ddddddddzdddfvld\n6-8 l: lllmllllll\n3-4 k: wqqkzwqgkqkk\n1-3 p: dppp\n5-9 p: ppkpppppjpt\n8-10 r: rmqjnrrrrldrn\n14-15 j: jjjjhjjjjjjjjjqj\n9-15 q: mqsfqcqlqqfpgkbb\n11-14 d: ddddhwxdddfrdddd\n5-7 h: hhhhhhfh\n6-7 q: qqlkdqjq\n10-11 r: rrrrrrrrrvrrf\n2-3 k: ftkkdc\n2-9 g: jpxcgggzgsgngrhght")
  (time (part1 puzzle-input)) ; 515
  (time (part2 puzzle-input)) ; 711
  )
